<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AG CNN Small Image</title>
  <link rel="stylesheet" href="assets/css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<body>
  <header>
    <div class="logo">
      <figure>
        <img src="assets/img/Logo_ifpa.png" alt="">
      </figure>
      <h1>AG CNN SMALL IMAGE</h1>
    </div>
    <div>
    <a><button class="btn" title="Modo Escuro" id="toggle-dark" ><i class="fa-solid fa-moon"></i></button></a>
    <a href="Resultados.html"><button class="btn" title="Resultados"> <i class="fa-solid fa-chart-pie"></i></button></a>
    </div>
  </header>

  <div class="container">
    <div class="card">
      <form id="configForm" autocomplete="off" method="post" action="/parametros" >
        <div class="input-group" title="NFC">
          <label for="nfc">NFC</label>
          <input required type="text" id="nfc" name="nfc" class="validacao_parametros" placeholder="Ex.: 0.1, 35, 10" />
        </div>
        <div class="input-group">
          <label for="learningRate">LEARNING RATE</label>
          <input required type="text" id="learningRate" name="learningRate" class="validacao_parametros" placeholder="Ex.: 0.001, 0.0005, 0.0001" />
        </div>
        <div class="input-group">
          <label for="batchSize">BATCH SIZE</label>
          <input required type="text" id="batchSize" name="batchSize" class="validacao_parametros" placeholder="Ex.: 32, 64, 128, 256"  />
        </div>
        <div class="input-group">
          <label for="filters">FILTERS</label>
          <input required type="text" id="filters" name="filters" class="validacao_parametros" placeholder="Ex.: 64, 128, 256, 512"  />
        </div>
        <div class="input-group">
          <label for="popSize">POP SIZE</label>
          <input required type="text" id="popSize" name="popSize" class="validacao_parametros" placeholder="Ex.: 15"/>
        </div>
        <div class="input-group">
          <label for="generations">GENERATIONS</label>
          <input required type="text" id="generations" name="generations" class="validacao_parametros" placeholder="Ex.: 30" />
        </div>
        <div class="input-group">
          <label for="mutationRate">MUTATION RATE</label>
          <input required type="text" id="mutationRate" name="mutationRate" class="validacao_parametros" placeholder="Ex.: 0.3"/>
        </div>
        <div class="input-group">
          <label for="dropout">DROPOUT</label>
          <input required type="text" id="dropout" name="dropout" class="validacao_parametros" placeholder="Ex.: 0.25, 0.3, 0.4, 0.5" />
        </div>
        <div class="input-group">
          <label for="weightDecay">WEIGHT DECAY</label>
          <input required type="text" id="weightDecay" name="weightDecay" class="validacao_parametros" placeholder="Ex.: 0.0001, 0.0005, 0.001" />
        </div>
        <div class="button-group">
          <button class="calculate-btn" type="submit">CALCULAR</button>
          <button class="clear-btn" type="reset">LIMPAR</button>
        </div>
      </form>
    </div>

    <div class="card info">
      <h3>SOBRE OS PARÂMETROS</h3>
      <div class="accordion">
        <div class="accordion-item">
          <div class="accordion-title">ALGORITMO GENÉTICO <span class="accordion-icon">▶</span></div>
          <div class="accordion-content">Otimização inspirada na seleção natural, que procura a melhor solução para um problema através de um processo iterativo que simula a evolução biológica</div>
        </div>
        <div class="accordion-item">
          <div class="accordion-title">LEARNING RATE <span class="accordion-icon">▶</span></div>
          <div class="accordion-content">Taxa de aprendizado define o quanto os pesos são ajustados durante a otimização.</div>
        </div>
        <div class="accordion-item">
          <div class="accordion-title">FILTERS <span class="accordion-icon">▶</span></div>
          <div class="accordion-content">Filtros são responsáveis por extrair características específicas nas imagens.</div>
        </div>
        <div class="accordion-item">
          <div class="accordion-title">BATCH SIZE <span class="accordion-icon">▶</span></div>
          <div class="accordion-content">Quantidade de amostras processadas antes da atualização do modelo.</div>
        </div>
        <div class="accordion-item">
          <div class="accordion-title">POP SIZE <span class="accordion-icon">▶</span></div>
          <div class="accordion-content">Tamanho da população utilizada no algoritmo genético.</div>
        </div>
        <div class="accordion-item">
          <div class="accordion-title">GENERATIONS <span class="accordion-icon">▶</span></div>
          <div class="accordion-content">Número de gerações para evoluir as soluções candidatas.</div>
        </div>
        <div class="accordion-item">
          <div class="accordion-title">MUTATION RATE <span class="accordion-icon">▶</span></div>
          <div class="accordion-content">Probabilidade de mutação durante o processo genético.</div>
        </div>
        <div class="accordion-item">
          <div class="accordion-title">DROPOUT <span class="accordion-icon">▶</span></div>
          <div class="accordion-content">Dropout é uma técnica de regularização usada em modelos de aprendizado profundo, particularmente Redes Neurais Convolucionais (CNNs), para evitar overfitting.</div>
        </div>
        <div class="accordion-item">
          <div class="accordion-title">WEIGHT DECAY <span class="accordion-icon">▶</span></div>
          <div class="accordion-content">Decaimento de Peso é uma técnica de regularização aplicada aos pesos de uma rede neural. Minimiza a função de perda.</div>
        </div>
      </div>
    </div>
  </div>
 <script>
  // Modo escuro
  const btn = document.getElementById('toggle-dark');

  // Ativa o modo escuro se estiver salvo no sessionStorage
  if (sessionStorage.getItem('darkMode') === 'true') {
    document.body.classList.add('dark-mode');
  }

  btn.addEventListener('click', () => {
    document.body.classList.toggle('dark-mode');

    // Atualiza o valor salvo no sessionStorage
    const isDarkMode = document.body.classList.contains('dark-mode');
    sessionStorage.setItem('darkMode', isDarkMode);
  });
</script>
<script>
  // Script para abrir/fechar accordion
    document.querySelectorAll('.accordion-title').forEach(title => {
      title.addEventListener('click', () => {
        const isActive = title.classList.contains('active');
        document.querySelectorAll('.accordion-title').forEach(t => t.classList.remove('active'));
        if (!isActive) {
          title.classList.add('active');
        }
      });
    });
</script>
<script>
  //regex
    const inputs = document.querySelectorAll('.validacao_parametros');

    function isDigit(char) {
      return /\d/.test(char);
    }

    function cleanInput(value) {
      let val = value.replace(/ /g, ',');
      val = val.replace(/[^0-9.,]/g, '');

      let result = '';
      for (let i = 0; i < val.length; i++) {
        const c = val[i];
        if (c === '.') {
          const prev = val[i - 1] || '';
          const next = val[i + 1] || '';
          const prevIsDigit = isDigit(prev);
          const nextIsDigit = isDigit(next);
          const prevIsComma = prev === ',';
          const nextIsComma = next === ',';
          if ((prevIsDigit || nextIsDigit) && !prevIsComma && !nextIsComma) {
            result += c;
          }
        } else if (c === ',') {
          const prev = val[i - 1] || '';
          if (prev !== ',') {
            result += c;
          }
        } else {
          result += c;
        }
      }
      return result;
    }

    inputs.forEach((input, index) => {
      const errorMsg = document.getElementById(`errorMsg${index + 1}`);

      input.addEventListener('input', () => {
        const originalValue = input.value;
        const cleaned = cleanInput(originalValue);

        if (cleaned !== originalValue) {
          const cursorPos = input.selectionStart - (originalValue.length - cleaned.length);
          input.value = cleaned;
          input.setSelectionRange(cursorPos, cursorPos);
        }
        errorMsg.textContent = '';
      });

      input.addEventListener('blur', () => {
        let val = input.value.trim();

        while (val.startsWith(',')) {
          val = val.slice(1);
        }
        while (val.endsWith(',') || val.endsWith('.')) { // Também remove ponto no fim
          val = val.slice(0, -1);
        }

        if (val === ',') {
          val = '';
        }

        if (val !== input.value) {
          input.value = val;
        }

        if (val.endsWith(',') || val.endsWith('.')) {
          errorMsg.textContent = 'O valor não pode terminar com vírgula ou ponto.';
        } else {
          errorMsg.textContent = '';
        }
      });
    });
</script>
</body>
</html>
